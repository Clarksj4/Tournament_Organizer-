h1. Developing the Website

h2. Docker
You will need docker to run the webserver as it is in a docker container. Note
that the initial install and setup of the docker image will require a lot of
shit to get downloaded. Be prepared to wait and don't try this at uni behind
some bullshit proxy.

* Install docker. You can do this in Windows - good luck to you sir!
* Get the config file. This might include passwords so is not included in git
(as that would go to github). You should get this from Higgins.
* docker-compose up -d
* You are done. To do it manually see below.

h3. Manual Installation
* Build the db servers:
** cd <to_dir>/player_database
** sudo docker build -t player_db .
** cd <to_dir>/tournament_database
** sudo docker build -t tournament_db .
* Build the webserver:
** cd <to_dir>/webserver
** sudo docker build -t webserver .
* Run these images to start the containers:
** sudo docker run --name=player_db -d -P player_db
** sudo docker run --name=tournament_db -d -P tournament_db
** sudo docker run --name=webserver -d -p 5000:5000 --link=player_db --link=tournament_db webserver

h2. Testing
Currently there is a smoketest and behat skeleton.
There is a test script @ scripts/test. You should just run this and you'll see all the output.

h3. Behat Testing
Behat is a tool for behaviour tests. This means that you script a little elf to run through scenarios in a browser. They then run through the tests, performing actions and expecting results. All features should have some behat tests associated with them. While in development you can use keywords to limit which tests actually get run by behat as the full suite might take some time. Behat tests are really good for testing whether something is functionally correct for the user.

h3. Smoke Testing
Smoke testing is basically a way to determine if the entire system is structurally compromised to the point where further tests are un-necessary. Essentially it tries to connect to all the systems involved to make sure they're up and running.

h3. Unit Tests
'''There are no unit tests currently'''
Unit tests are tests on individual functions. These ensure that they are functionally correct on a much more fine-grained level than the behat tests (that test the final product). All functions should have a unit test associated with them.

h3. View Tests
'''There are no view tests currently'''
View tests assert that the system ''looks'' correct for the user. This involves automated screenshots usually. There are a number of suites available for this. We should look into one once we start making the view pretty.

h2. Adding new files

If you want to add new files to the webserver you simply need to rebuild the
container (manually or using scripts/install). Note that only the src directory
gets mounted into the container. You can add other directories by altering the
Dockerfile (c.f. the ADD commands at the bottom.

h2. Connecting to the Player DB
The recommended way to connect to the db is to enter the webserver container
and then connect to the player_db container from there. Attach to the
webserver and run the command:
* sudo docker exec -i -t webserver /bin/bash
* psql-db # This has been aliased
# Notes: When we run the webserver we tell it to link to the player_db
# container and this will insert some ENV variables into the web container
# ('$DB_PORT_5432_TCP_ADDR', etc.). You will be asked the docker user
# password to connect. You can find it in the Dockerfile of the player_database
# directory.
